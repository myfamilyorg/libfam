/********************************************************************************
 * MIT License
 *
 * Copyright (c) 2025 Christopher Gilliard
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 *******************************************************************************/

#ifndef _VERIHASH_H
#define _VERIHASH_H

#include <libfam/types.h>

#define FIELD_SIZE 8
#define FULL_ROUNDS 8
#define PARTIAL_ROUNDS 22

static const __attribute__((
    aligned(32))) u64 const_data[FULL_ROUNDS + PARTIAL_ROUNDS][FIELD_SIZE] = {
    {7574726470920687474ULL, 12188614715309930291ULL, 16395621729422251894ULL,
     5756478834793241953ULL, 17239718071701302822ULL, 1991418932626276363ULL,
     9027966199268108657ULL, 11133894463118605443ULL},
    {10675140083034405752ULL, 9767878003837707786ULL, 9825850905371352492ULL,
     5042205572681108718ULL, 14788955377955236956ULL, 3680721670708674448ULL,
     6240071497804293279ULL, 5002493574263886456ULL},
    {2955685916316057384ULL, 12303827600382718942ULL, 2087550881184015137ULL,
     5717314656131854494ULL, 8476977229832821529ULL, 5214870891776464166ULL,
     10192243612575230744ULL, 13550925011572767472ULL},
    {2787662641449221363ULL, 6783566761152892482ULL, 1032011334853862477ULL,
     554487670877739338ULL, 14452414925090181650ULL, 10612021680628790988ULL,
     548096316498094632ULL, 8103148178690522573ULL},
    {13210561076486074171ULL, 6011715552123905008ULL, 347819918318410764ULL,
     11302963075237462271ULL, 7632113693670859231ULL, 2918607014171389782ULL,
     910823152583849233ULL, 16202469167188788993ULL},
    {7318457171704986860ULL, 6645069748612991600ULL, 16561040944546554245ULL,
     18010462032429102453ULL, 6547715737946584877ULL, 15219433604945739670ULL,
     14826953003672931904ULL, 1904789642286276640ULL},
    {253675235859029932ULL, 10641418966496065075ULL, 17193615627887531502ULL,
     13768777434665250653ULL, 14832422688438006570ULL, 3746122243337559208ULL,
     18200223725162243782ULL, 1572420789895709543ULL},
    {12586783369879623920ULL, 3786402027346447345ULL, 14217797053608093979ULL,
     5236092325339993868ULL, 16027456621017654910ULL, 16575958625138769576ULL,
     5475052546674588068ULL, 6662112032802919540ULL},
    {2655400619439475998ULL, 14357403603541154604ULL, 1984773992891470744ULL,
     14720880377820759732ULL, 13330726997907062111ULL, 18402259591479847130ULL,
     4688404641954273475ULL, 14484192914932807123ULL},
    {8288466776053851163ULL, 17503903709916720128ULL, 15404456793880250044ULL,
     11312089635254654820ULL, 11340641453535921236ULL, 1112531775592731521ULL,
     4233211627928194936ULL, 14628962950990711313ULL},
    {13000065036336528376ULL, 17018020976596067621ULL, 4747898390312594837ULL,
     6946426968763160302ULL, 13658815347377340015ULL, 17547112752978129385ULL,
     1795799960471916573ULL, 13127802877626837125ULL},
    {1691026807195890922ULL, 3021836305387316245ULL, 17793314638651241253ULL,
     11988285362856505133ULL, 17485496868733450367ULL, 16197766912288973349ULL,
     15378222480856516514ULL, 15437881864998210528ULL},
    {7997941516376389346ULL, 15286471839012628367ULL, 7720879733567424773ULL,
     17663881588271003489ULL, 478846294818758221ULL, 1951462496406614389ULL,
     6060477391150048803ULL, 10760164388804243376ULL},
    {15836611239295746111ULL, 5227164965178217884ULL, 15823279692627346236ULL,
     4019566991725197982ULL, 8569659618743628342ULL, 4947522434811057380ULL,
     2614398950673304129ULL, 503852505539103774ULL},
    {8074666150861791270ULL, 2157182503050843996ULL, 8795705275405175990ULL,
     10026571151241287355ULL, 1118438312645928291ULL, 16887559434323076653ULL,
     3409776380918156587ULL, 16508159808505130215ULL},
    {18248057800881899963ULL, 56142038256943000ULL, 12307533398109402624ULL,
     6919993207949612841ULL, 12161397880157413999ULL, 7917456264639583261ULL,
     6859322109058238627ULL, 12232065191362411833ULL},
    {5602802561059973530ULL, 10994253415613845136ULL, 8412976929862706141ULL,
     10494420007969669489ULL, 3366305153170855493ULL, 15084762346535388548ULL,
     5367531242886180965ULL, 1028724954522235610ULL},
    {9410099386533301171ULL, 18184234980597160905ULL, 2116608982510280410ULL,
     6970325297802148414ULL, 2729691747839310799ULL, 3033949828482940897ULL,
     10424998516545000071ULL, 15477313982608563761ULL},
    {3230630189364249560ULL, 5856590414471923942ULL, 10383352348569486631ULL,
     11179426603471203742ULL, 1131433172274633716ULL, 3486523440777693313ULL,
     11352332054730376675ULL, 4627214731819782368ULL},
    {6417414361191032805ULL, 13421520208562672581ULL, 4221508372888002513ULL,
     1793480716065161301ULL, 8775542926821178165ULL, 6482025287367558006ULL,
     15165156162152902525ULL, 6159029450307749362ULL},
    {13800527341190023789ULL, 15694932038173031868ULL, 10219311314140416042ULL,
     6617448947593354318ULL, 15810570020481261903ULL, 2635986980569954168ULL,
     10258982306978974790ULL, 9038228870888488450ULL},
    {4088758415712378607ULL, 11074580440439615702ULL, 11297265055447776748ULL,
     983746699040811290ULL, 2287143208170306478ULL, 17015486678595893884ULL,
     11241891766759727479ULL, 7782547108529829228ULL},
    {16320566448493303609ULL, 2213079025951127570ULL, 17507834706067644792ULL,
     4550148288764113545ULL, 6549703753448109056ULL, 17674440894978235879ULL,
     15288904332852527239ULL, 4065488490897154190ULL},
    {2538048257815440723ULL, 5987572384516645881ULL, 4794468733846743148ULL,
     3103932079585301577ULL, 13667155300643621199ULL, 4496953413630269393ULL,
     11543849221545036371ULL, 12262611406907269230ULL},
    {8818500104096477099ULL, 8084133433987336429ULL, 9127229832069711720ULL,
     16126433761731576978ULL, 12372442042327479728ULL, 17714831933616249167ULL,
     17913722538038595395ULL, 16246706558692027656ULL},
    {6615347928828966135ULL, 3411034798891413896ULL, 14705013739844561295ULL,
     17103574764054993504ULL, 3030087188060953478ULL, 2644028634517898252ULL,
     17078905150401161187ULL, 16074039280989438583ULL},
    {14835822670348259636ULL, 14518282921529298318ULL, 15194217814710159116ULL,
     16789303791343061925ULL, 5373147488681371176ULL, 15180389678046099153ULL,
     18178361429802213023ULL, 12987298096200389806ULL},
    {11307939544681923391ULL, 13652885013093813288ULL, 16764349087467518536ULL,
     1639625717216282017ULL, 8588706901559206645ULL, 18272473355927370495ULL,
     9821873313156804126ULL, 7255383250762775563ULL},
    {14028658398610214645ULL, 14582475132246352908ULL, 8507306956612511587ULL,
     8140430188889209099ULL, 2569987631871349746ULL, 16711818334169621144ULL,
     14884742477105016091ULL, 3229439533991374334ULL},
    {3671155491408543183ULL, 10033569935016005202ULL, 8489295014142854843ULL,
     17099290005589039325ULL, 1280251341598391758ULL, 6163326578315864090ULL,
     18380003598250534603ULL, 4005464516269337158ULL}};

u128 verihash128(const u8 *in, u64 len);
void verihash256(const u8 *in, u64 len, u8 out[32]);

#endif /* _VERIHASH_H */
